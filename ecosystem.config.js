// O:\hh\ecosystem.config.js
module.exports = {
  apps : [
    {
      name   : "TorAPI",                // Имя процесса для PM2
      script : "./TorAPI-main/main.js", // !!! ВАЖНО: Укажите ПРАВИЛЬНЫЙ стартовый JS-файл TorAPI !!!
                                        // (Может быть index.js или другой, проверьте package.json TorAPI)
      cwd    : "./TorAPI-main",         // Рабочая директория для TorAPI
      watch  : false,                   // Не перезапускать при изменении файлов TorAPI
      // Указываем порт и окружение через переменные среды
      // PM2 передаст их в запускаемый процесс
      env: {
        NODE_ENV: "production",         // Рекомендуется для производительности
        PORT: 8443                      // Порт, на котором должен слушать TorAPI
      }
    },
    {
      name   : "Backend",               // Имя вашего основного бэкенда
      script : "./server.js",           // Путь к вашему основному бэкенд-серверу
      cwd    : ".",                     // Рабочая директория (корень проекта)
      // Перезапуск при изменении server.js или data.json
      watch  : ["./server.js", "./data.json"],
      ignore_watch: ["node_modules", "public", ".git"], // Папки/файлы, которые не отслеживать
      watch_options: {
        followSymlinks: false
      },
      // Переменные окружения для вашего бэкенда
      // PM2 прочитает ваш .env файл автоматически, если он в корне,
      // но можно явно указать переменные здесь для переопределения или надежности.
      env: {
        NODE_ENV: "production",
        // PORT: 3000, // Можно взять из .env или указать здесь
        // YOUTUBE_API_KEY: 'ВАШ_КЛЮЧ' // Можно взять из .env или указать здесь
      }
    }
  ]
};